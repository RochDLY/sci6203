<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Roch Delannay">
<meta name="dcterms.date" content="2022-11-08">

<title>SCI6203 - Écriture du TP02</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">SCI6203</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../rendu1-YA.html">Analyse par Yann Audin</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../rendu1-RD.html">Analyse par Roch Delannay</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">À propos</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/RochDLY/sci6203"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Écriture du TP02</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">journal</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Roch Delannay </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 8, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Compte-rendu du TP02 : description du corpus de données.</p>
<section id="présentation-du-corpus" class="level2">
<h2 class="anchored" data-anchor-id="présentation-du-corpus">Présentation du corpus</h2>
<p>Vitali-Rosati, Marcello, Elsa Bouchard, Christian Raschle. “Pour une édition numérique collaborative de l’Anthologie grecque.” Chaire de recherche du Canada sur les écritures numériques, Accédé le 9 novembre 2022, &lt;url = https://anthologiagraeca.org/&gt;.</p>
<p>Pour une liste complète des collaborateurs (coordination, développement, éditeurs, partenaires, etc.), consulter le site web <a href="https://anthologiagraeca.org/pages/equipe-et-partenaires/">https://anthologiagraeca.org/pages/equipe-et-partenaires/</a>.</p>
<p>Une grande partie des textes en grec ancien et des traductions en anglais sont tirés de :</p>
<p>Paton, W. R. <em>The Greek Anthology</em>. Harvard University Press; W. Heinemann, New York, 1916-18. (Cinq vo)</p>
<section id="le-manuscrit" class="level3">
<h3 class="anchored" data-anchor-id="le-manuscrit">Le manuscrit</h3>
<ol start="4" type="1">
<li>Critères linguistiques − [x] Genre − [ ] Registre de langue − [x] Langue</li>
</ol>
<p>L’Anthologie grecque est un recueil qui regroupe la poésie épigrammatique grecque issue de la période classique jusqu’à la période byzantine, soit près de 4000 pièces, de 325 auteurs différents, s’étalant sur plus de 15 siècles. Telle que nous la possédons aujourd’hui, l’Anthologie a une histoire complexe <span class="citation" data-cites="cameron_greek_1993">[@cameron_greek_1993]</span>. L’expression « Anthologie grecque » désigne l’ensemble constitué par deux parties. D’une part, l’Anthologie palatine, un manuscrit datant du X<sup>e</sup> siècle (le <em>Codex Palatinus 23</em>) retrouvé en 1606 par Claude Saumaise à la Bibliothèque palatine d’Heidelberg. D’autre part, l’<em>Appendix Planudea</em>, soit les épigrammes absentes du manuscrit palatin présentes dans l’Anthologie de Planude, une compilation datant du début du XIV<sup>e</sup> siècle, rédigée par Maxime Planude <span class="citation" data-cites="aubreton_tradition_1968 beta_moi_2019">[@aubreton_tradition_1968; @beta_moi_2019]</span>.</p>
<p>Monument de la littérature, l’Anthologie est le document principal qui nous transmet la poésie épigrammatique antique <span class="citation" data-cites="gutzwiller_poetics_1997 gutzwiller_poetic_1998">[@gutzwiller_poetics_1997; @gutzwiller_poetic_1998]</span>. Né en Grèce, le genre de l’épigramme évolue de manière significative dans l’histoire de la littérature grecque, mais également au sein même de l’Anthologie. Initialement composée pour être gravée (<em>epigramma</em> signifie « texte inscrit sur un objet »), l’épigramme se présente comme un petit poème, simple, composé d’une ou de deux lignes. Les premières épigrammes étaient des épitaphes ou des inscriptions accompagnant une statue, un don ou un ex-voto. Vers le VI<sup>e</sup> siècle, ces inscriptions se versifient. Dès l’époque hellénistique, l’épigramme se détache de son support, se diversifie dans son propos et devient un véritable genre littéraire, caractérisée par sa brièveté (<em>brevitas</em>) et son trait piquant (<em>argutia</em>), et se grave désormais non pas dans le marbre, mais dans l’esprit du lectorat.</p>
<p>[LES LIVRES DE L’AP]</p>
</section>
<section id="description-de-lapi" class="level3">
<h3 class="anchored" data-anchor-id="description-de-lapi">Description de l’API</h3>
<p>[DISTINGUER L’API DU MANUSCRIT]</p>
<p>La Chaire de recherche du Canada sur les écritures numériques porte depuis 2014 un projet de recherche initialement intitulé “Édition numérique collaborative de l’Anthologie Palatine et de ses multiples vérités”, puis “Pour une édition numérique collaborative de l’Anthologie grecque” suite à l’intégration du manuscrit de Planude dans le projet. L’un des développements mené dans cette recherche consiste à rendre disponible ce manuscrit sur le Web grâce à une <a href="https://anthologiagraeca.org/api/">API</a> (<em>Application Programming Interface</em>) : chacune des épigrammes devient un fragment accessible au moyen d’une requête <code>GET</code>. Ce dispositif est documenté sur un <a href="http://api-doc.anthologiagraeca.org/">site web</a> dédié. Dans ce projet de fouille de texte, cette API sur laquelle nous nous appuyons pour construire notre corpus offre une collection de 4134 épigrammes en Grec ancien rédigées par 309 auteurs<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> répandus sur 16 siècles d’histoire. L’ensemble de ce manuscrit est disponible en accès libre. Nous remercions la Chaire de recherche du Canada sur les écritures numériques, La Perseus Digital Library, La Bibliothèque palatine (Heidelberg), et la Bibliothèque Nationale de France (Gallica).</p>
<p>[INFORMATION SUPPLÉMENTAIRE SUR LES PARTENAIRES]</p>
</section>
<section id="récupération-des-données" class="level3">
<h3 class="anchored" data-anchor-id="récupération-des-données">Récupération des données</h3>
<ol start="2" type="1">
<li>Critères technologiques − [x] Provenance − [x] Support − [x] Format(s) des documents constituants le corpus</li>
<li>Critères Informationnels − [x] Discipline − [ ] Sujets − [x] Présentation sommaire du corpus − [ ] Justification du lien entre la tâche à réaliser et le corpus</li>
</ol>
<p>Les données sont disponibles via l’API à l’URL suivante : http://anthologiagraeca.org/api/passages. Pour ne pas travailler uniquement depuis l’API, nous avons décidé d’exporter l’ensemble des épigrammes du corpus dans un fichier que nous garderons en local. Pour ce faire, nous avons réalisé un petit script en <code>python</code> décrit ci-dessous. L’ensemble des données de l’API sont accessibles via l’<em>endpoint</em>, pour les récupérer, nous les injectons sous forme de liste dans une variable <code>results</code>. L’API sert les données paginées, de fait les données récupérées sont limitées à la première page. Or nous voulons récupérer l’ensemble du corpus. Pour parer cette fonctionnalité nous créons une boucle <code>while</code> pour modifier l’URL de la page (vers la page suivante) et indexer toutes les données de chacune des pages de l’API dans notre variable.</p>
<pre class="python="><code># Importation of the useful libraries 
# Definition of our variables for the requests 

import requests
import json
import csv

url = 'http://anthologiagraeca.org/api/passages'
parameters = {
    'format':'json',
    'limit':'500'
}
results = []
pagination= True
while pagination == True :
    data = requests.get(url, parameters).json()
    for result in data['results'] :
        results.append(result)
    if data['next'] is None:
        pagination = False
    else:
        url = data['next']
</code></pre>
<p>La première vérification consiste à comparer le nombre de résultats obtenus avec le nombre total d’épigrammes indexées dans le portail de l’Anthologie grecque.</p>
<pre class="python="><code>len(results)</code></pre>
<pre class="python="><code>    4134</code></pre>
<p>Maintenant que nous avons bien récupéré nos données, nous souhaitons créer un fichier au format <code>JSON</code> que nous pourrons utiliser pour les futures étapes de notre fouille de texte.</p>
<p>Nouvel export : nous avions prévu de travailler uniquement avec le format <code>JSON</code>, mais la plupart des logiciels de fouille de textes prennent en charge le format <code>CSV</code> en entrée ! Du coup nous avons retravaillé l’export de l’API pour avoir du <code>JSON</code> et du <code>CSV</code>.</p>
<pre class="python="><code># Export au format json
mesTextes = []
for epigram in results:
    mesTextes.append({'url': epigram['url'], 'greekText': [text for text in epigram['texts'] if text['language'] == 'grc']})

# Export au format csv
mesChamps = ['url', 'greekText']
mesEpigrammes = []
for epigram in results:
    for text in epigram['texts']:
        if text['language'] == 'grc':
            mesEpigrammes.append([epigram['url'], text['text']])</code></pre>
<pre class="python="><code># Export au format json
out_file = open('greek-epigram.json', 'w')

json.dump(mesTextes, out_file, indent=3, ensure_ascii=False)

# Export au format csv
with open('EpigramsGreek.csv', 'w') as f:
      
    # using csv.writer method from CSV package
    write = csv.writer(f)
      
    write.writerow(mesChamps)
    write.writerows(mesEpigrammes)</code></pre>
<p>Le résultat obtenu avec ce script comporte un document <code>JSON</code> et un document <code>CSV</code> contenant les épigrammes grecques et les URL (via l’API) qui permettent de les identifier.</p>
</section>
<section id="informations-précises-sur-le-corpus" class="level3">
<h3 class="anchored" data-anchor-id="informations-précises-sur-le-corpus">Informations précises sur le corpus</h3>
<p>En plus de présenter un intérêt certain pour l’étude du genre épigrammatique <span class="citation" data-cites="prioux_petits_2008">[@prioux_petits_2008]</span>, l’Anthologie grecque constitue un corpus précieux et diversifié de formes intertextuelles, dont celle de la variation. Plusieurs des auteurs de l’Anthologie s’inspirent en effet les uns des autres <span class="citation" data-cites="waltz_anthologie_1960">[@waltz_anthologie_1960]</span>. La <em>variatio</em>, forme très spécifique d’intertextualité commune et prisée dans la littérature grecque, consiste à reprendre une pièce d’un autre auteur et de la réécrire avec des variations stylistiques, rhétoriques ou paradigmatiques <span class="citation" data-cites="laurens_abeille_1989">[@laurens_abeille_1989]</span>. Le procédé était particulièrement apprécié des épigrammatistes : la simplicité de la forme permettait aux auteurs de s’illustrer en l’espace de quelques vers. Ainsi, l’épigramme est souvent décrite comme un art de la variation en tant que tel <span class="citation" data-cites="taran_art_1979">[@taran_art_1979]</span>. La nature même du corpus anthologique (la réunion de poèmes hétéroclites néanmoins reliés par des topoï communs) en fait une source d’intertextualité inépuisable. Certains thèmes reviennent particulièrement fréquemment, et les épigrammes se répondent, parfois avec plusieurs siècles de décalage <span class="citation" data-cites="gutzwiller_poetic_1998">[@gutzwiller_poetic_1998]</span>. Cette forme (qui s’apparente presque à du plagiat), bien vue et encouragée par les pratiques rhétoriques, commande la production de la littérature grecque et son évolution <span class="citation" data-cites="laurens_abeille_1989">[@laurens_abeille_1989]</span>.</p>
<p>Les épigrammes sont rassemblées approximativement par sujets dans seize livres, les premiers offrant une plus grande cohérence thématique et les derniers étant plus libres.</p>
<p>[INFORMATION PRÉCISE SUR LE CORPUS] - [ ] Taille (nombre de mots du corpus entier et moyenne approximative du nombre de mots des documents) - [ ] Information sur l’API</p>
</section>
<section id="preprocessing-avec-orange-data-mining" class="level3">
<h3 class="anchored" data-anchor-id="preprocessing-avec-orange-data-mining">Preprocessing avec <a href="https://orangedatamining.com/">Orange Data Mining</a></h3>
<p>Le corpus au format <code>CSV</code> est brut, nous y trouvons seulement les épigrammes grecques et leur URL pour les identifier, mais nous aurons certainement besoin de le compléter avec d’autres informations et/ou de le réduire pour correspondre au mieux à notre problématique sur les variations.</p>
<p><img src="imagesSCI6203-tp02/csv.png" class="img-fluid"></p>
<p><img src="imagesSCI6203-tp02/preprocessing1.PNG" class="img-fluid"></p>
<p>Afin de comprendre comment nous allons pouvoir travailler avec cet objet, nous avons décidé d’effectuer des premiers tests de <em>preprocessing</em> avec le logiciel <em>Orange Data Mining</em>. Orange est un outil de programmation visuelle, l’utilisation de <code>widgets</code> dans l’espace de travail du logiciel permet de créer un <code>workflow</code> et d’appliquer une suite d’opérations aux données du corpus. Nous avons suivi l’un des workflows proposé en exemple dans la documentation du logiciel afin d’observer la forme des résultats que nous pouvons obtenir. Les widgets utilisés sont les suivants :</p>
<ul>
<li><code>Preprocess Text</code> : ce widget permet de transformer (lowercase), de tokeniser (expression régulière <code>\w+</code>), de normaliser (lemmatiser selon les lemmes grecs) et de filtrer (liste de <em>stopwords</em> créée par l’équipe de la CRCEN, et suppression des tokens en dehors d’une certaine fréquence) le corpus d’épigrammes. Avec 4218 <code>instances</code> en entrée nous obtenons 64637 <code>tokens</code> et 36279 <code>types</code>. Ce résultat n’a jamais été deux fois le même selon les paramètres utilisés.</li>
</ul>
<p><img src="imagesSCI6203-tp02/preprocessingcorpus.PNG" class="img-fluid"></p>
<ul>
<li>Orange permet d’ores et déjà une première visualisation du corpus sous forme de nuage de mots grâce au widget <code>Word Cloud</code>.</li>
</ul>
<p><img src="imagesSCI6203-tp02/wordCloud.PNG" class="img-fluid"></p>
<ul>
<li>Le widget suivant s’appelle <code>Bag of Words</code>, il créé un compteur de la fréquence de chaque terme du corpus.</li>
<li><code>Distances</code> calcule la distance (cosinus dans notre cas) entre chaque ligne du fichier source : il détermine la proximité entre les lignes.</li>
<li><code>Hierarchical Clustering</code> offre une visualisation sous forme de cluster des distances calculées précédemment.</li>
</ul>
<p><img src="imagesSCI6203-tp02/hierarchicalClustering.PNG" class="img-fluid"></p>
<ul>
<li>Les deux derniers widgets, <code>Corpus Viewer</code> et <code>MDS</code> permettent des visualisation plus fines des clusters : en sélection un cluster particulier ou un ensemble de clusters il est possible de les afficher soit sous forme brute dans Corpus Viewer (et voir leur contenus) soit sous forme de graphe avec MDS.</li>
</ul>
<p><img src="imagesSCI6203-tp02/CorpusViewer.PNG" class="img-fluid"></p>
<p><img src="imagesSCI6203-tp02/mds.PNG" class="img-fluid"></p>
<p>Les résultats que nous obtenons permettent de faire un premier état des lieux sur notre corpus : il nous faut correctement composer ce dernier pour commencer à réellement travailler à la problématique sur les variations. Toutefois, les regroupements par clusters (à partir des distances par cosinus) ne sont pas sans intérêt, en effet, nous remarquons que les clusters regroupent des mot-clefs appartenant à un même champ lexical. Si nous reprenons l’exemple affiché précédemment, les épigrammes du cluster sont articulées autour des mots clefs “Muse”, “peinture”, “écriture”. Cette méthode d’apprentissage automatique fait partie de l’ensemble des méthodes non supervisées (conseillée à la fin du TP01) et fera l’objet d’une attention particulière pour les prochains développements de cette étude.</p>
<ol start="5" type="1">
<li>Difficultés rencontrées et commentaires − [x] Veuillez indiquer les difficultés que vous avez rencontrées ou les commentaires que vous jugez pertinents de noter lors de la constitution de votre corpus, le cas échéant.</li>
</ol>
<p>L’API est un projet incomplet auquel des modifications sont encore apportées presque toutes les semaines, en ce sens il est importante de noter que cinq des épigrammes n’ont pas de textes en grec qui leurs sont associés dans le json. Les épigrammes 7.0 et 11.0 n’ont simplement pas de texte en grec qui leurs sont associés, bien que des images de fragments existent pour chacun. Similairement, le texte 16.10 contient uniquement les caractères “῀.”. Finalement, deux épigrammes du livre 11 ont vu leurs textes en grec être encodé “eng” plutôt que “grc” de sorte qu’une recherche automatique ne découvre pas de texte en grec ancien pour les fragments 376 et 382 de ce livre. Dans le cadre de notre fouille de texte en python, ces erreurs étaient assez peu nombreuses pour que nous puissions les corriger à la main.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>L’API du projet liste 310 auteur, mais l’un de ces derniers est “anonyme”, nous étudions donc 309 auteurs connus et un nombre inconnu d’auteurs anonymes. La documentation quant à elle mentionne 325 auteurs, il est possible que ces 16 auteurs supplémentaires n’aient pas encore été ajoutés à l’API.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>